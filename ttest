function runwithopts(func, minargs, maxargs)
    @assert minargs <= length(ARGS) <= maxargs "Wrong number of arguments"
    debug, infile, outfile = false, "", stdout
    for arg in ARGS
        if arg == "-d" || arg == "-debug" 
            debug = true
        elseif isempty(infile)
            infile = arg
        else
            outfile = arg
        end
    end
    func(infile, outfile, debug)
end

runwithopts(preprocess, 1, 3)
