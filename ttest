mutable struct Brick
    zmin::Int
    blocks::Vector{CartesianIndex}
end

function test()
    bricks = Brick[]
    for line in eachline(".txt")
        ends = [parse.(Int, x) for x in split.(split(s, "~"), ",")]
        xs, ys, zs = [min(a[1][i], a[2][i]):max(a[1][i], a[2][i]) for i in 1:3]
        blocks = vec([CartesianIndex(x, y, z) for x in xs, y in ys, z in zs])
        push!(bricks, Brick(zs.start, blocks))
    end

function settle(bricks)
    settled = empty(bricks)
    occupied, moved = Set{CartesianIndex}(), Set{Int}()
    for (i, brick) in bricks
        if brick.zmin == 1 || any(b -> b in occupied, filter(blo -> blo[3] == block.zmin, brick.blocks))
            push!(settled, brick)
            foreach(b -> push!(occupied, b), brick.blocks)
            break
        end
        brick.blocks .-= CartesianIndex(0, 0, 1)
        brick.zmin -= 1
        push!(settled, i)
    end
    return settled, length(occupied)
end

